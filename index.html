<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Roofy Presale - Shiba Dino-Dog Token</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; }
        .gradient-text { background: linear-gradient(to right, #f97316, #dc2626); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .gradient-bg { background: linear-gradient(135deg, #f97316 0%, #dc2626 100%); }
        .pulse { animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }
        .wallet-connected { background: linear-gradient(135deg, #10b981 0%, #059669 100%) !important; }
        .shake { animation: shake 0.5s; }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-5px); } 75% { transform: translateX(5px); } }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #fed7aa; }
        ::-webkit-scrollbar-thumb { background: #f97316; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #ea580c; }
    </style>
</head>
<body class="bg-gradient-to-b from-amber-50 to-orange-50 min-h-screen">
    <!-- Header -->
    <nav class="bg-white/90 backdrop-blur-sm border-b border-orange-200 sticky top-0 z-50 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center">
            <div class="flex items-center space-x-3">
                <div class="text-3xl shake">ü¶äü¶ñ</div>
                <div>
                    <h1 class="text-2xl font-bold gradient-text">ROOFY</h1>
                    <p class="text-xs text-gray-500">The Shiba Dino-Dog</p>
                </div>
            </div>
            <div class="flex items-center space-x-4">
                <a href="#story" class="hidden md:block text-gray-700 hover:text-orange-600 font-medium">Story</a>
                <a href="#tokenomics" class="hidden md:block text-gray-700 hover:text-orange-600 font-medium">Tokenomics</a>
                <button id="connectWallet" class="gradient-bg text-white px-6 py-3 rounded-full font-semibold hover:opacity-90 transition-all">
                    <i class="fas fa-wallet mr-2"></i>Connect Wallet
                </button>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="py-12 px-4">
        <div class="max-w-6xl mx-auto">
            <!-- Live Banner -->
            <div class="gradient-bg rounded-2xl p-4 text-white text-center mb-8 pulse">
                <div class="flex items-center justify-center">
                    <div class="w-3 h-3 bg-white rounded-full mr-3 animate-pulse"></div>
                    <span class="font-bold text-lg">üöÄ PRESALE IS LIVE! 50% Bonus for Early Birds</span>
                </div>
            </div>

            <div class="text-center mb-12">
                <div class="inline-block bg-white/20 backdrop-blur-sm rounded-full p-4 mb-6">
                    <div class="text-6xl animate-bounce">ü¶äü¶ñ</div>
                </div>
                <h1 class="text-5xl md:text-7xl font-bold mb-6">
                    Meet <span class="gradient-text">Roofy</span>
                </h1>
                <p class="text-xl text-gray-700 max-w-2xl mx-auto mb-8">
                    The Shiba Inu who became a dinosaur to make a little girl smile. 
                    Now he lives forever on Solana as a memorial token.
                </p>
                <div class="flex flex-wrap justify-center gap-4 mb-8">
                    <div class="bg-white/20 backdrop-blur-sm rounded-full px-6 py-2 gradient-text border border-orange-300">
                        üíù In Memory of Lily
                    </div>
                    <div class="bg-white/20 backdrop-blur-sm rounded-full px-6 py-2 gradient-text border border-orange-300">
                        ü¶ñ Dino-Dog Spirit
                    </div>
                    <div class="bg-white/20 backdrop-blur-sm rounded-full px-6 py-2 gradient-text border border-orange-300">
                        üåÖ Eternal Sunset
                    </div>
                </div>
            </div>

            <!-- Presale Stats -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-12">
                <div class="bg-white rounded-2xl p-6 shadow-lg border border-orange-200 text-center">
                    <div class="text-3xl font-bold gradient-text" id="totalRaised">0</div>
                    <div class="text-gray-600">Total Raised (SOL)</div>
                </div>
                <div class="bg-white rounded-2xl p-6 shadow-lg border border-orange-200 text-center">
                    <div class="text-3xl font-bold gradient-text" id="totalBuyers">0</div>
                    <div class="text-gray-600">Total Buyers</div>
                </div>
                <div class="bg-white rounded-2xl p-6 shadow-lg border border-orange-200 text-center">
                    <div class="text-3xl font-bold gradient-text">200K</div>
                    <div class="text-gray-600">Tokens per SOL</div>
                </div>
                <div class="bg-white rounded-2xl p-6 shadow-lg border border-orange-200 text-center">
                    <div class="text-3xl font-bold gradient-text">3K</div>
                    <div class="text-gray-600">Hard Cap (SOL)</div>
                </div>
            </div>

            <!-- Main Presale Card -->
            <div class="max-w-2xl mx-auto bg-white rounded-3xl shadow-2xl border-2 border-orange-300 overflow-hidden mb-16">
                <div class="gradient-bg p-6 text-white relative">
                    <div class="absolute top-4 right-4">
                        <span class="bg-white/20 px-3 py-1 rounded-full text-sm">üî• LIVE</span>
                    </div>
                    <h2 class="text-3xl font-bold text-center">$ROOFY Presale</h2>
                    <p class="text-center opacity-90 mt-2">Hard Cap: 3,000 SOL ‚Ä¢ Price increases every tier</p>
                    
                    <!-- Progress Bar -->
                    <div class="mt-6">
                        <div class="flex justify-between text-sm mb-2">
                            <span>Progress</span>
                            <span id="progressPercent">0%</span>
                        </div>
                        <div class="h-3 bg-white/30 rounded-full overflow-hidden">
                            <div id="progressBar" class="h-full bg-white rounded-full transition-all duration-1000" style="width: 0%"></div>
                        </div>
                        <div class="flex justify-between text-xs mt-2">
                            <span>0 SOL</span>
                            <span id="currentRaised">0 SOL</span>
                            <span>3,000 SOL</span>
                        </div>
                    </div>
                </div>

                <div class="p-6 md:p-8">
                    <!-- Connection Status -->
                    <div id="walletStatus" class="mb-6 p-4 bg-gradient-to-r from-amber-50 to-orange-50 rounded-xl text-center border border-amber-200">
                        <p class="text-amber-700"><i class="fas fa-info-circle mr-2"></i>Connect wallet to participate in presale</p>
                    </div>

                    <!-- Wallet Info (when connected) -->
                    <div id="walletInfo" class="hidden mb-6 p-4 bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl border border-green-200">
                        <div class="flex justify-between items-center">
                            <div>
                                <p class="font-medium text-green-800"><i class="fas fa-check-circle mr-2"></i>Wallet Connected</p>
                                <p id="walletAddress" class="text-sm text-green-600 font-mono"></p>
                            </div>
                            <button onclick="disconnectWallet()" class="text-red-600 hover:text-red-800">
                                <i class="fas fa-sign-out-alt"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Amount Input -->
                    <div class="mb-6">
                        <label class="block text-gray-700 mb-3 font-semibold text-lg">
                            <i class="fas fa-coins mr-2"></i>Amount to Invest (SOL)
                        </label>
                        <div class="relative">
                            <input type="number" id="amount" value="0.1" min="0.01" step="0.01" 
                                   class="w-full bg-gray-50 border-2 border-orange-300 rounded-xl py-4 px-6 text-2xl font-bold pr-20 focus:outline-none focus:ring-2 focus:ring-orange-200 focus:border-orange-500">
                            <div class="absolute right-6 top-4 text-2xl">‚óé</div>
                        </div>
                        <div class="text-sm text-gray-500 mt-2">
                            <i class="fas fa-info-circle mr-1"></i> Min: 0.01 SOL ‚Ä¢ Max: 100 SOL per transaction
                        </div>
                    </div>

                    <!-- Quick Select -->
                    <div class="mb-6">
                        <div class="text-sm text-gray-600 mb-3"><i class="fas fa-bolt mr-2"></i>Quick select (SOL):</div>
                        <div class="grid grid-cols-5 gap-2">
                            <button class="quick-amount py-3 bg-gray-100 hover:bg-orange-100 border border-gray-300 hover:border-orange-400 rounded-lg transition-colors" data-amount="0.1">0.1</button>
                            <button class="quick-amount py-3 bg-gray-100 hover:bg-orange-100 border border-gray-300 hover:border-orange-400 rounded-lg transition-colors" data-amount="0.5">0.5</button>
                            <button class="quick-amount py-3 bg-gray-100 hover:bg-orange-100 border border-gray-300 hover:border-orange-400 rounded-lg transition-colors" data-amount="1">1</button>
                            <button class="quick-amount py-3 bg-gray-100 hover:bg-orange-100 border border-gray-300 hover:border-orange-400 rounded-lg transition-colors" data-amount="2">2</button>
                            <button class="quick-amount py-3 bg-gray-100 hover:bg-orange-100 border border-gray-300 hover:border-orange-400 rounded-lg transition-colors" data-amount="5">5</button>
                        </div>
                    </div>

                    <!-- Referral Code -->
                    <div class="mb-6">
                        <label class="block text-gray-700 mb-3 font-semibold">
                            <i class="fas fa-user-friends mr-2"></i>Referral Code (Optional - Get 5% Bonus!)
                        </label>
                        <div class="relative">
                            <input type="text" id="referralCode" 
                                   class="w-full border-2 border-purple-300 rounded-xl py-3 px-4 pr-32 focus:outline-none focus:ring-2 focus:ring-purple-200 focus:border-purple-500" 
                                   placeholder="Enter ROOFY code">
                            <div class="absolute right-3 top-3">
                                <span class="px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-sm font-medium">+5% Bonus</span>
                            </div>
                        </div>
                    </div>

                    <!-- Tokens Display -->
                    <div class="bg-gradient-to-r from-orange-50 to-amber-50 rounded-xl p-6 mb-6 border border-orange-200">
                        <div class="space-y-4">
                            <div class="flex justify-between items-center">
                                <span class="text-gray-700">Base tokens:</span>
                                <span class="font-bold text-lg" id="baseTokens">0</span>
                            </div>
                            <div class="flex justify-between items-center text-green-600 hidden" id="bonusSection">
                                <span>Referral bonus (5%):</span>
                                <span class="font-bold text-lg" id="bonusTokens">0</span>
                            </div>
                            <div class="border-t border-orange-300 pt-4">
                                <div class="flex justify-between items-center">
                                    <div>
                                        <div class="font-semibold text-lg">Total receive:</div>
                                        <div class="text-sm text-gray-600">Airdropped within 24h after presale</div>
                                    </div>
                                    <div class="text-right">
                                        <div id="totalTokens" class="text-3xl font-bold text-orange-600">0</div>
                                        <div class="text-sm">ROOFY tokens</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Buy Button -->
                    <button id="buyButton" 
                            class="w-full gradient-bg text-white py-5 rounded-xl text-xl font-bold hover:opacity-90 transition-all disabled:opacity-50 hover:scale-[1.02] active:scale-[0.98] shadow-lg hover:shadow-xl"
                            disabled>
                        <i class="fas fa-lock mr-2"></i>CONNECT WALLET TO BUY
                    </button>

                    <!-- Transaction Status -->
                    <div id="transactionStatus" class="mt-4 hidden">
                        <div class="bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-4 border border-green-200">
                            <div class="flex items-center">
                                <div class="text-green-500 text-2xl mr-3">
                                    <i class="fas fa-check-circle"></i>
                                </div>
                                <div>
                                    <p class="font-medium text-green-800">Transaction Submitted!</p>
                                    <p class="text-sm text-green-600 mt-1">Tokens will be airdropped after presale ends</p>
                                    <p id="txHash" class="text-xs text-green-500 font-mono mt-2"></p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Purchases -->
                    <div class="mt-8 pt-6 border-t border-gray-200">
                        <h4 class="font-bold mb-4"><i class="fas fa-history mr-2"></i>Recent Purchases</h4>
                        <div id="recentPurchases" class="space-y-3 max-h-48 overflow-y-auto">
                            <div class="text-center text-gray-500 py-4">
                                <i class="fas fa-sync-alt animate-spin mr-2"></i>Loading purchases...
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Story Section -->
            <div id="story" class="mt-16 max-w-3xl mx-auto">
                <div class="bg-gradient-to-br from-amber-50 to-orange-50 rounded-2xl p-8 border border-amber-200">
                    <div class="flex items-center mb-6">
                        <div class="text-3xl mr-3">üìñ</div>
                        <h3 class="text-2xl font-bold text-gray-800">The Roofy Story</h3>
                    </div>
                    
                    <div class="space-y-6">
                        <div class="flex items-start">
                            <div class="text-2xl mr-4 flex-shrink-0">ü¶ä</div>
                            <div>
                                <h4 class="font-bold text-lg mb-2">Our Shiba Rusty</h4>
                                <p class="text-gray-700">A curious, loyal Shiba Inu with the classic smile. Always ready for adventure.</p>
                            </div>
                        </div>
                        
                        <div class="flex items-start">
                            <div class="text-2xl mr-4 flex-shrink-0">üëß</div>
                            <div>
                                <h4 class="font-bold text-lg mb-2">Lily's Magic</h4>
                                <p class="text-gray-700">"Look Daddy! Rusty turned into ROOFY the dinosaur!" she'd giggle every sunset.</p>
                            </div>
                        </div>
                        
                        <div class="flex items-start">
                            <div class="text-2xl mr-4 flex-shrink-0">üåÖ</div>
                            <div>
                                <h4 class="font-bold text-lg mb-2">Sunset Ritual</h4>
                                <p class="text-gray-700">Evening dino-costume zoomies filled our home with laughter and magic.</p>
                            </div>
                        </div>
                        
                        <div class="flex items-start">
                            <div class="text-2xl mr-4 flex-shrink-0">üí´</div>
                            <div>
                                <h4 class="font-bold text-lg mb-2">Eternal Memory</h4>
                                <p class="text-gray-700">Roofy now watches sunsets forever as a Solana token, keeping Lily's magic alive.</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-8 pt-6 border-t border-amber-300 text-center">
                        <p class="text-gray-600 italic">
                            "For every child who saw magic in ordinary things, 
                            and every pet who became a legend."
                        </p>
                        <div class="flex justify-center mt-4 space-x-2">
                            <span class="text-xs px-3 py-1 bg-amber-100 text-amber-800 rounded-full">Lily's Legacy</span>
                            <span class="text-xs px-3 py-1 bg-pink-100 text-pink-800 rounded-full">Always remembered</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tokenomics -->
            <div id="tokenomics" class="mt-16 max-w-3xl mx-auto">
                <div class="bg-white rounded-2xl p-8 shadow-lg border border-orange-200">
                    <h3 class="text-2xl font-bold mb-6"><i class="fas fa-chart-pie mr-2"></i>Tokenomics</h3>
                    
                    <div class="space-y-6">
                        <div>
                            <h4 class="font-bold text-lg mb-3">üìä Distribution</h4>
                            <div class="space-y-3">
                                <div class="flex justify-between items-center">
                                    <span>Presale (50%)</span>
                                    <span class="font-bold">500,000,000 ROOFY</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span>Liquidity (30%)</span>
                                    <span class="font-bold">300,000,000 ROOFY</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span>Marketing (10%)</span>
                                    <span class="font-bold">100,000,000 ROOFY</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span>Lily's Fund (10%)</span>
                                    <span class="font-bold">100,000,000 ROOFY</span>
                                </div>
                            </div>
                        </div>
                        
                        <div>
                            <h4 class="font-bold text-lg mb-3">‚ö° Features</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                <div class="flex items-center">
                                    <i class="fas fa-check text-green-500 mr-2"></i>
                                    <span>2% Auto-burn</span>
                                </div>
                                <div class="flex items-center">
                                    <i class="fas fa-check text-green-500 mr-2"></i>
                                    <span>2% Holder rewards</span>
                                </div>
                                <div class="flex items-center">
                                    <i class="fas fa-check text-green-500 mr-2"></i>
                                    <span>1% Charity wallet</span>
                                </div>
                                <div class="flex items-center">
                                    <i class="fas fa-check text-green-500 mr-2"></i>
                                    <span>Anti-whale protection</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gradient-to-r from-gray-900 to-black text-white py-12 mt-16">
        <div class="max-w-6xl mx-auto px-4">
            <div class="grid md:grid-cols-3 gap-8">
                <div>
                    <div class="flex items-center mb-6">
                        <div class="text-3xl mr-3">ü¶äü¶ñ</div>
                        <div>
                            <h3 class="text-2xl font-bold">$ROOFY</h3>
                            <p class="text-sm text-gray-400">The Shiba Dino-Dog</p>
                        </div>
                    </div>
                    <p class="text-gray-400">
                        A memorial token keeping Lily's magic alive through her beloved Shiba Inu.
                    </p>
                </div>
                
                <div>
                    <h4 class="text-lg font-bold mb-4">Quick Links</h4>
                    <div class="space-y-2">
                        <a href="#" class="block text-gray-400 hover:text-white transition-colors">Presale</a>
                        <a href="#story" class="block text-gray-400 hover:text-white transition-colors">Story</a>
                        <a href="#tokenomics" class="block text-gray-400 hover:text-white transition-colors">Tokenomics</a>
                        <a href="#" class="block text-gray-400 hover:text-white transition-colors">Twitter</a>
                    </div>
                </div>
                
                <div>
                    <h4 class="text-lg font-bold mb-4">In Loving Memory</h4>
                    <div class="bg-gray-800/30 rounded-xl p-4">
                        <p class="text-gray-400 text-sm">
                            "For Lily, who taught us to see dinosaurs in every Shiba and magic in every sunset."
                        </p>
                        <div class="mt-3 pt-3 border-t border-gray-700">
                            <p class="text-xs text-gray-500">2021 - 2023 ‚Ä¢ Forever in our hearts</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="mt-8 pt-8 border-t border-gray-800 text-center text-gray-500 text-sm">
                <p>This is a memecoin. Invest responsibly. 10% of presale funds go to charity.</p>
                <p class="mt-2">¬© 2024 Roofy Token. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
        // =============== CONFIGURATION ===============
        // üî• IMPORTANT: REPLACE THIS WITH YOUR WALLET ADDRESS!
        const DEV_WALLET = 'YOUR_SOLANA_WALLET_ADDRESS_HERE'; // ‚ö†Ô∏è CHANGE THIS!
        
        // Presale settings
        const PRESALE_CAP = 3000; // 3000 SOL hard cap
        const TOKENS_PER_SOL = 200000; // 1 SOL = 200,000 ROOFY
        const MIN_PURCHASE = 0.01;
        const MAX_PURCHASE = 100;
        const REFERRAL_BONUS = 0.05; // 5%

        // =============== STATE ===============
        let wallet = null;
        let publicKey = null;
        let connection = null;
        let totalRaised = 0;
        let recentPurchases = [];

        // =============== DOM ELEMENTS ===============
        const elements = {
            connectBtn: document.getElementById('connectWallet'),
            walletStatus: document.getElementById('walletStatus'),
            walletInfo: document.getElementById('walletInfo'),
            walletAddress: document.getElementById('walletAddress'),
            amountInput: document.getElementById('amount'),
            buyButton: document.getElementById('buyButton'),
            transactionStatus: document.getElementById('transactionStatus'),
            txHash: document.getElementById('txHash'),
            progressBar: document.getElementById('progressBar'),
            progressPercent: document.getElementById('progressPercent'),
            currentRaised: document.getElementById('currentRaised'),
            totalRaisedEl: document.getElementById('totalRaised'),
            totalBuyersEl: document.getElementById('totalBuyers'),
            baseTokens: document.getElementById('baseTokens'),
            bonusSection: document.getElementById('bonusSection'),
            bonusTokens: document.getElementById('bonusTokens'),
            totalTokens: document.getElementById('totalTokens'),
            recentPurchases: document.getElementById('recentPurchases'),
            referralCode: document.getElementById('referralCode')
        };

        // =============== INITIALIZATION ===============
        document.addEventListener('DOMContentLoaded', () => {
            // Check if Phantom is installed
            if (window.solana && window.solana.isPhantom) {
                wallet = window.solana;
                wallet.on('connect', () => handleWalletConnect(wallet.publicKey));
                wallet.on('disconnect', () => handleWalletDisconnect());
                
                // Try to auto-connect
                if (wallet.isConnected) {
                    handleWalletConnect(wallet.publicKey);
                }
            }

            // Initialize Solana connection
            connection = new solanaWeb3.Connection(
                solanaWeb3.clusterApiUrl('devnet'), // Change to 'mainnet-beta' for production
                'confirmed'
            );

            // Set up event listeners
            setupEventListeners();
            
            // Update UI
            updateTokenCalculation();
            simulateLiveStats();
            loadRecentPurchases();
        });

        // =============== WALLET FUNCTIONS ===============
        async function handleWalletConnect(publicKeyObj) {
            publicKey = publicKeyObj.toString();
            
            // Update UI
            elements.connectBtn.innerHTML = `<i class="fas fa-wallet mr-2"></i>${publicKey.slice(0, 4)}...${publicKey.slice(-4)}`;
            elements.connectBtn.classList.add('wallet-connected');
            elements.walletStatus.classList.add('hidden');
            elements.walletInfo.classList.remove('hidden');
            elements.walletAddress.textContent = publicKey;
            elements.buyButton.disabled = false;
            elements.buyButton.innerHTML = `<i class="fas fa-bolt mr-2"></i>BUY ROOFY TOKENS`;
            
            // Get balance
            try {
                const balance = await connection.getBalance(publicKeyObj);
                console.log(`Wallet balance: ${balance / solanaWeb3.LAMPORTS_PER_SOL} SOL`);
            } catch (err) {
                console.log('Could not fetch balance');
            }
        }

        function handleWalletDisconnect() {
            publicKey = null;
            elements.connectBtn.innerHTML = `<i class="fas fa-wallet mr-2"></i>Connect Wallet`;
            elements.connectBtn.classList.remove('wallet-connected');
            elements.walletStatus.classList.remove('hidden');
            elements.walletInfo.classList.add('hidden');
            elements.buyButton.disabled = true;
            elements.buyButton.innerHTML = `<i class="fas fa-lock mr-2"></i>CONNECT WALLET TO BUY`;
            elements.transactionStatus.classList.add('hidden');
        }

        function disconnectWallet() {
            if (wallet) {
                wallet.disconnect();
            }
            handleWalletDisconnect();
        }

        // =============== EVENT LISTENERS ===============
        function setupEventListeners() {
            // Connect wallet button
            elements.connectBtn.addEventListener('click', async () => {
                if (!wallet) {
                    alert('Please install Phantom wallet from phantom.app');
                    window.open('https://phantom.app', '_blank');
                    return;
                }

                try {
                    await wallet.connect();
                } catch (err) {
                    console.error('Connection error:', err);
                    alert('Failed to connect wallet. Please try again.');
                }
            });

            // Quick amount buttons
            document.querySelectorAll('.quick-amount').forEach(btn => {
                btn.addEventListener('click', () => {
                    elements.amountInput.value = btn.dataset.amount;
                    updateTokenCalculation();
                });
            });

            // Amount input
            elements.amountInput.addEventListener('input', updateTokenCalculation);

            // Referral code input
            elements.referralCode.addEventListener('input', updateTokenCalculation);

            // Buy button
            elements.buyButton.addEventListener('click', handlePurchase);
        }

        // =============== TOKEN CALCULATION ===============
        function updateTokenCalculation() {
            const amount = parseFloat(elements.amountInput.value) || 0;
            const baseTokens = Math.floor(amount * TOKENS_PER_SOL);
            
            // Check referral bonus
            const hasReferral = elements.referralCode.value.trim().length > 0;
            const bonusTokens = hasReferral ? Math.floor(baseTokens * REFERRAL_BONUS) : 0;
            const totalTokens = baseTokens + bonusTokens;

            // Update UI
            elements.baseTokens.textContent = baseTokens.toLocaleString();
            elements.totalTokens.textContent = totalTokens.toLocaleString();
            
            if (hasReferral && bonusTokens > 0) {
                elements.bonusSection.classList.remove('hidden');
                elements.bonusTokens.textContent = `+${bonusTokens.toLocaleString()}`;
            } else {
                elements.bonusSection.classList.add('hidden');
            }
        }

        // =============== PURCHASE HANDLING ===============
        async function handlePurchase() {
            if (!publicKey) {
                alert('Please connect your wallet first');
                return;
            }

            const amount = parseFloat(elements.amountInput.value);
            
            // Validation
            if (isNaN(amount) || amount < MIN_PURCHASE) {
                alert(`Minimum purchase is ${MIN_PURCHASE} SOL`);
                return;
            }

            if (amount > MAX_PURCHASE) {
                alert(`Maximum purchase per transaction is ${MAX_PURCHASE} SOL`);
                return;
            }

            if (totalRaised + amount > PRESALE_CAP) {
                alert(`Purchase would exceed hard cap! Maximum remaining: ${(PRESALE_CAP - totalRaised).toFixed(2)} SOL`);
                return;
            }

            // Update button state
            const originalText = elements.buyButton.innerHTML;
            elements.buyButton.disabled = true;
            elements.buyButton.innerHTML = `<i class="fas fa-spinner fa-spin mr-2"></i>Processing...`;

            try {
                // Create transaction
                const transaction = new solanaWeb3.Transaction().add(
                    solanaWeb3.SystemProgram.transfer({
                        fromPubkey: new solanaWeb3.PublicKey(publicKey),
                        toPubkey: new solanaWeb3.PublicKey(DEV_WALLET),
                        lamports: Math.floor(amount * solanaWeb3.LAMPORTS_PER_SOL * 0.99), // 1% buffer
                    })
                );

                // Get recent blockhash
                const { blockhash, lastValidBlockHeight } = await connection.getLatestBlockhash();
                transaction.recentBlockhash = blockhash;
                transaction.feePayer = new solanaWeb3.PublicKey(publicKey);

                // Sign and send transaction
                const signedTransaction = await wallet.signTransaction(transaction);
                const signature = await connection.sendRawTransaction(signedTransaction.serialize());

                // Confirm transaction
                await connection.confirmTransaction({
                    signature,
                    blockhash,
                    lastValidBlockHeight
                }, 'confirmed');

                // Update UI
                elements.transactionStatus.classList.remove('hidden');
                elements.txHash.textContent = `TX: ${signature.slice(0, 16)}...${signature.slice(-8)}`;
                
                // Update stats
                totalRaised += amount;
                updateStats();
                
                // Add to recent purchases
                addRecentPurchase(amount);
                
                // Show success message
                const tokens = Math.floor(amount * TOKENS_PER_SOL);
                const bonus = elements.referralCode.value.trim() ? Math.floor(tokens * REFERRAL_BONUS) : 0;
                const total = tokens + bonus;
                
                alert(`‚úÖ Purchase Successful!\n\n` +
                      `Amount: ${amount} SOL\n` +
                      `Tokens: ${total.toLocaleString()} ROOFY\n` +
                      `${bonus ? `Bonus: +${bonus.toLocaleString()} ROOFY\n` : ''}` +
                      `Transaction: ${signature.slice(0, 8)}...\n\n` +
                      `Tokens will be airdropped within 24 hours after presale ends!`);

                // Reset form
                elements.amountInput.value = '0.1';
                elements.referralCode.value = '';
                updateTokenCalculation();

            } catch (err) {
                console.error('Transaction error:', err);
                alert(`Transaction failed: ${err.message || 'Unknown error'}`);
            } finally {
                // Reset button
                elements.buyButton.disabled = false;
                elements.buyButton.innerHTML = originalText;
            }
        }

        // =============== STATS UPDATES ===============
        function updateStats() {
            const progress = (totalRaised / PRESALE_CAP) * 100;
            
            elements.progressBar.style.width = `${progress}%`;
            elements.progressPercent.textContent = `${progress.toFixed(1)}%`;
            elements.currentRaised.textContent = `${totalRaised.toFixed(2)} SOL`;
            elements.totalRaisedEl.textContent = totalRaised.toFixed(2);
        }

        function simulateLiveStats() {
            // Simulate initial stats
            totalRaised = 1245.67;
            updateStats();
            elements.totalBuyersEl.textContent = '1,245';
            
            // Simulate live updates
            setInterval(() => {
                if (Math.random() > 0.7) { // 30% chance of new purchase
                    const randomAmount = 0.1 + Math.random() * 5;
                    totalRaised += randomAmount;
                    if (totalRaised > PRESALE_CAP) totalRaised = PRESALE_CAP;
                    updateStats();
                    
                    // Add fake purchase
                    if (recentPurchases.length < 10) {
                        addRecentPurchase(randomAmount);
                    }
                }
            }, 5000);
        }

        function addRecentPurchase(amount) {
            const now = new Date();
            const timeString = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            const tokens = Math.floor(amount * TOKENS_PER_SOL);
            
            recentPurchases.unshift({
                time: timeString,
                amount: amount.toFixed(2),
                tokens: tokens.toLocaleString()
            });
            
            // Keep only last 5 purchases
            if (recentPurchases.length > 5) {
                recentPurchases.pop();
            }
            
            loadRecentPurchases();
        }

        function loadRecentPurchases() {
            elements.recentPurchases.innerHTML = '';
            
            if (recentPurchases.length === 0) {
                elements.recentPurchases.innerHTML = `
                    <div class="text-center text-gray-500 py-4">
                        <i class="fas fa-shopping-cart mr-2"></i>No purchases yet
                    </div>
                `;
                return;
            }
            
            recentPurchases.forEach(purchase => {
                const purchaseEl = document.createElement('div');
                purchaseEl.className = 'flex justify-between items-center p-3 hover:bg-orange-50 rounded-lg';
                purchaseEl.innerHTML = `
                    <div class="flex items-center">
                        <div class="w-2 h-2 bg-green-500 rounded-full mr-3"></div>
                        <div>
                            <div class="font-medium">${purchase.time}</div>
                            <div class="text-xs text-gray-500">just now</div>
                        </div>
                    </div>
                    <div class="text-right">
                        <div class="font-bold">${purchase.amount} SOL</div>
                        <div class="text-xs text-orange-600">${purchase.tokens} ROOFY</div>
                    </div>
                `;
                elements.recentPurchases.appendChild(purchaseEl);
            });
        }

        // =============== HELPER FUNCTIONS ===============
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                alert('Copied to clipboard!');
            });
        }

        // Initial update
        updateTokenCalculation();
    </script>
</body>
</html>
