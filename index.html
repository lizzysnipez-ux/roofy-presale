<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Roofy Presale - Shiba Dino-Dog Token</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Mobile optimization */
        html { -webkit-text-size-adjust: 100%; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            -webkit-tap-highlight-color: transparent;
            background: linear-gradient(to bottom, #fffbeb 0%, #fed7aa 100%) !important;
        }
        .gradient-text { background: linear-gradient(to right, #f97316, #dc2626); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .gradient-bg { background: linear-gradient(135deg, #f97316 0%, #dc2626 100%); }
        .pulse { animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }
        .wallet-connected { background: linear-gradient(135deg, #10b981 0%, #059669 100%) !important; }
        
        /* Better mobile touch targets */
        button, input, .touch-target {
            min-height: 44px;
            min-width: 44px;
        }
        
        /* Fix for Phantom mobile deep linking */
        .phantom-deep-link {
            display: inline-block;
            padding: 12px 24px;
            background: linear-gradient(135deg, #AB9FF2 0%, #7B61FF 100%);
            color: white;
            border-radius: 12px;
            text-decoration: none;
            font-weight: bold;
            margin: 10px 0;
        }
        
        /* Mobile responsive adjustments */
        @media (max-width: 768px) {
            .mobile-stack { flex-direction: column !important; }
            .mobile-text-center { text-align: center !important; }
            .mobile-p-4 { padding: 1rem !important; }
            .mobile-text-3xl { font-size: 1.875rem !important; }
            .mobile-text-4xl { font-size: 2.25rem !important; }
            .mobile-grid-cols-1 { grid-template-columns: 1fr !important; }
            .mobile-hidden { display: none !important; }
            .mobile-block { display: block !important; }
        }
        
        /* Meme gallery styles */
        .meme-grid {
            display: grid;
            gap: 1rem;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        }
        
        .meme-item {
            transition: transform 0.3s ease;
            cursor: pointer;
        }
        
        .meme-item:hover {
            transform: scale(1.05);
        }
        
        /* Custom scrollbar for mobile */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #fed7aa; }
        ::-webkit-scrollbar-thumb { background: #f97316; border-radius: 3px; }
        
        /* Token image styling */
        .token-image-container {
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(249, 115, 22, 0.1);
            border: 3px solid #f97316;
        }
        
        .token-image {
            width: 100%;
            height: auto;
            border-radius: 15px;
            object-fit: cover;
        }
        
        /* Force light theme for Phantom */
        @media (prefers-color-scheme: dark) {
            body {
                background: linear-gradient(to bottom, #fffbeb 0%, #fed7aa 100%) !important;
                color: #1f2937 !important;
            }
            .bg-white {
                background-color: white !important;
            }
            .text-gray-700, .text-gray-600, .text-gray-500 {
                color: #4b5563 !important;
            }
        }
    </style>
</head>
<body class="bg-gradient-to-b from-amber-50 to-orange-50 min-h-screen">
    <!-- Mobile Navigation -->
    <nav class="bg-white/95 backdrop-blur-sm border-b border-orange-200 sticky top-0 z-50 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center space-x-3">
                <!-- Replace this with your token logo -->
                <img src="https://chocolate-solid-skunk-453.mypinata.cloud/ipfs/bafkreigq22tzxessrj6mvdfcgw4xchwxcphvbbblrylwfunr2w63nhq7xq" alt="Roofy Logo" class="w-10 h-10 rounded-full">
                <div>
                    <h1 class="text-xl font-bold gradient-text mobile-hidden">ROOFY</h1>
                    <p class="text-xs text-gray-500 mobile-hidden">The Shiba Dino-Dog</p>
                </div>
            </div>
            <div class="flex items-center space-x-3">
                <button id="mobileMenu" class="md:hidden text-gray-700">
                    <i class="fas fa-bars text-xl"></i>
                </button>
                <button id="connectWallet" class="gradient-bg text-white px-4 py-2 rounded-full font-semibold text-sm md:px-6 md:py-3 md:text-base">
                    <i class="fas fa-wallet mr-2"></i><span class="mobile-hidden">Connect</span>
                </button>
            </div>
        </div>
        
        <!-- Mobile Menu -->
        <div id="mobileMenuContent" class="md:hidden bg-white border-t border-orange-200 hidden">
            <div class="px-4 py-3 space-y-3">
                <a href="#presale" class="block text-gray-700 hover:text-orange-600 font-medium py-2">Presale</a>
                <a href="#token" class="block text-gray-700 hover:text-orange-600 font-medium py-2">Token</a>
                <a href="#memes" class="block text-gray-700 hover:text-orange-600 font-medium py-2">Memes</a>
                <a href="#story" class="block text-gray-700 hover:text-orange-600 font-medium py-2">Story</a>
                <a href="#tokenomics" class="block text-gray-700 hover:text-orange-600 font-medium py-2">Tokenomics</a>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="py-8 md:py-12 px-4">
        <div class="max-w-6xl mx-auto">
            <!-- Live Banner -->
            <div class="gradient-bg rounded-2xl p-3 md:p-4 text-white text-center mb-6 pulse">
                <div class="flex items-center justify-center">
                    <div class="w-2 h-2 bg-white rounded-full mr-2 md:mr-3 animate-pulse"></div>
                    <span class="font-bold text-sm md:text-lg">üöÄ PRESALE IS LIVE! 50% Bonus for First 500 SOL</span>
                </div>
            </div>

            <div class="text-center mb-8">
                <!-- Hero Token Image -->
                <div class="token-image-container max-w-md mx-auto mb-6">
                    <!-- REPLACE THIS IMAGE WITH YOUR TOKEN IMAGE -->
                    <img src="https://chocolate-solid-skunk-453.mypinata.cloud/ipfs/bafkreigq22tzxessrj6mvdfcgw4xchwxcphvbbblrylwfunr2w63nhq7xq" 
                         alt="Roofy Token" 
                         class="token-image">
                </div>
                
                <h1 class="text-3xl md:text-5xl lg:text-7xl font-bold mb-4 md:mb-6">
                    Meet <span class="gradient-text">Roofy</span>
                </h1>
                <p class="text-base md:text-xl text-gray-700 max-w-2xl mx-auto mb-6 md:mb-8">
                    The Shiba Inu who became a dinosaur to make a little girl smile. 
                    Now he lives forever on Solana.
                </p>
                
                <!-- Token Address Display -->
                <div class="max-w-2xl mx-auto bg-white/80 backdrop-blur-sm rounded-2xl p-4 md:p-6 border border-orange-200 mb-6">
                    <h3 class="font-bold text-lg mb-2"><i class="fas fa-fingerprint mr-2"></i>Token Address</h3>
                    <div class="flex flex-col md:flex-row items-center justify-between">
                        <code class="bg-gray-100 px-4 py-2 rounded-lg text-sm md:text-base font-mono break-all">
                            BLKj7mTgRa9Fg1vCDqZeNaBSjyekF4xpK72fMWikZYmq
                        </code>
                        <button onclick="copyTokenAddress()" class="mt-2 md:mt-0 md:ml-4 px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors">
                            <i class="fas fa-copy mr-2"></i>Copy
                        </button>
                    </div>
                </div>
            </div>

            <!-- Presale Stats -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-4 mb-8 md:mb-12">
                <div class="bg-white rounded-xl md:rounded-2xl p-4 shadow-lg border border-orange-200 text-center">
                    <div class="text-xl md:text-3xl font-bold gradient-text" id="totalRaised">0</div>
                    <div class="text-xs md:text-gray-600">Total Raised (SOL)</div>
                </div>
                <div class="bg-white rounded-xl md:rounded-2xl p-4 shadow-lg border border-orange-200 text-center">
                    <div class="text-xl md:text-3xl font-bold gradient-text" id="totalBuyers">0</div>
                    <div class="text-xs md:text-gray-600">Total Buyers</div>
                </div>
                <div class="bg-white rounded-xl md:rounded-2xl p-4 shadow-lg border border-orange-200 text-center">
                    <div class="text-xl md:text-3xl font-bold gradient-text" id="currentPrice">250K</div>
                    <div class="text-xs md:text-gray-600">Tokens per SOL</div>
                </div>
                <div class="bg-white rounded-xl md:rounded-2xl p-4 shadow-lg border border-orange-200 text-center">
                    <div class="text-xl md:text-3xl font-bold gradient-text">1K</div>
                    <div class="text-xs md:text-gray-600">Hard Cap (SOL)</div>
                </div>
            </div>

            <!-- Token Image Gallery Section -->
            <div id="token" class="mt-12 md:mt-16">
                <div class="text-center mb-6 md:mb-8">
                    <h2 class="text-2xl md:text-3xl font-bold mb-3 md:mb-4">üñºÔ∏è $ROOFY Token & Art</h2>
                    <p class="text-gray-600 text-base md:text-lg max-w-2xl mx-auto">Official token images and community artwork</p>
                </div>

                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-8 mb-8">
                    <!-- Token Logo -->
                    <div class="token-image-container">
                        <div class="text-center mb-4">
                            <span class="bg-orange-100 text-orange-800 px-3 py-1 rounded-full text-sm font-medium">
                                <i class="fas fa-certificate mr-1"></i> Official Logo
                            </span>
                        </div>
                        <!-- REPLACE THIS WITH YOUR LOGO -->
                        <img src="https://chocolate-solid-skunk-453.mypinata.cloud/ipfs/bafkreigq22tzxessrj6mvdfcgw4xchwxcphvbbblrylwfunr2w63nhq7xq" 
                             alt="Roofy Official Logo" 
                             class="token-image mb-4">
                        <h3 class="font-bold text-lg text-center mb-2">$ROOFY Logo</h3>
                        <p class="text-gray-600 text-sm text-center">The official token logo</p>
                    </div>

                    <!-- Token Art 1 -->
                    <div class="token-image-container">
                        <div class="text-center mb-4">
                            <span class="bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm font-medium">
                                <i class="fas fa-palette mr-1"></i> Community Art
                            </span>
                        </div>
                        <!-- REPLACE THIS WITH YOUR ART 1 -->
                        <img src="https://chocolate-solid-skunk-453.mypinata.cloud/ipfs/bafkreian65uqi46ycwlu4mpcteeu4ofkgtvhczouetbnz44y4msmjh2cgi" 
                             alt="Roofy Art 1" 
                             class="token-image mb-4">
                        <h3 class="font-bold text-lg text-center mb-2">Roofy & Lily</h3>
                        <p class="text-gray-600 text-sm text-center">Shiba dinosaur with little girl</p>
                    </div>

                    <!-- Token Art 2 -->
                    <div class="token-image-container">
                        <div class="text-center mb-4">
                            <span class="bg-pink-100 text-pink-800 px-3 py-1 rounded-full text-sm font-medium">
                                <i class="fas fa-palette mr-1"></i> Community Art
                            </span>
                        </div>
                        <!-- REPLACE THIS WITH YOUR ART 2 -->
                        <img src="https://chocolate-solid-skunk-453.mypinata.cloud/ipfs/bafkreidbf3i3qvznsiml6zxiijl2jzd47jhvllo55umz4zm6k3pa36dnp4" 
                             alt="Roofy Art 2" 
                             class="token-image mb-4">
                        <h3 class="font-bold text-lg text-center mb-2">Moon Mission</h3>
                        <p class="text-gray-600 text-sm text-center">Roofy going to the moon</p>
                    </div>
                </div>

                <!-- Image Upload Instructions -->
                <div class="bg-gradient-to-r from-blue-50 to-cyan-50 rounded-2xl p-6 md:p-8 border border-blue-200">
                    <h3 class="text-xl md:text-2xl font-bold mb-4 text-center">üìÅ How to Add Your Images</h3>
                    <div class="max-w-2xl mx-auto">
                        <div class="grid md:grid-cols-3 gap-4 md:gap-6">
                            <div class="text-center">
                                <div class="w-12 h-12 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center mx-auto mb-3">
                                    <i class="fas fa-upload text-xl"></i>
                                </div>
                                <h4 class="font-bold mb-2">1. Upload Images</h4>
                                <p class="text-sm text-gray-600">Upload to <a href="https://imgur.com" target="_blank" class="text-blue-600 font-semibold">Imgur</a> or <a href="https://imgbb.com" target="_blank" class="text-blue-600 font-semibold">ImgBB</a></p>
                            </div>
                            <div class="text-center">
                                <div class="w-12 h-12 bg-green-100 text-green-600 rounded-full flex items-center justify-center mx-auto mb-3">
                                    <i class="fas fa-link text-xl"></i>
                                </div>
                                <h4 class="font-bold mb-2">2. Get Direct Link</h4>
                                <p class="text-sm text-gray-600">Copy the direct image URL (ends with .jpg, .png, .gif)</p>
                            </div>
                            <div class="text-center">
                                <div class="w-12 h-12 bg-orange-100 text-orange-600 rounded-full flex items-center justify-center mx-auto mb-3">
                                    <i class="fas fa-code text-xl"></i>
                                </div>
                                <h4 class="font-bold mb-2">3. Replace in Code</h4>
                                <p class="text-sm text-gray-600">Replace placeholder URLs in the code with your image links</p>
                            </div>
                        </div>
                        
                        <!-- Code Example -->
                        <div class="mt-6 bg-gray-900 rounded-xl p-4 overflow-x-auto">
                            <pre class="text-sm text-white"><code>&lt;!-- Replace this URL with your image --&gt;
&lt;img src="<span class="text-yellow-300">YOUR_IMAGE_URL_HERE</span>" 
     alt="Roofy Token" 
     class="token-image"&gt;</code></pre>
                        </div>
                        
                        <p class="text-center text-sm text-gray-600 mt-4">
                            <i class="fas fa-info-circle mr-2"></i>
                            Look for <code class="bg-gray-100 px-2 py-1 rounded text-xs">REPLACE THIS</code> comments in the code
                        </p>
                    </div>
                </div>
            </div>

            <!-- Main Presale Card -->
            <div id="presale" class="max-w-2xl mx-auto bg-white rounded-2xl md:rounded-3xl shadow-xl md:shadow-2xl border-2 border-orange-300 overflow-hidden mb-12 md:mb-16">
                <div class="gradient-bg p-4 md:p-6 text-white">
                    <div class="absolute top-3 right-3 md:top-4 md:right-4">
                        <span class="bg-white/20 px-2 py-1 md:px-3 md:py-1 rounded-full text-xs md:text-sm">üî• LIVE</span>
                    </div>
                    <h2 class="text-xl md:text-3xl font-bold text-center">$ROOFY Presale</h2>
                    <p class="text-center opacity-90 mt-1 md:mt-2 text-sm md:text-base">Hard Cap: 1,000 SOL ‚Ä¢ Price increases every tier</p>
                    
                    <!-- Progress Bar -->
                    <div class="mt-4 md:mt-6">
                        <div class="flex justify-between text-xs md:text-sm mb-1 md:mb-2">
                            <span>Progress</span>
                            <span id="progressPercent">0%</span>
                        </div>
                        <div class="h-2 md:h-3 bg-white/30 rounded-full overflow-hidden">
                            <div id="progressBar" class="h-full bg-white rounded-full transition-all duration-1000" style="width: 0%"></div>
                        </div>
                        <div class="flex justify-between text-xs mt-1 md:mt-2">
                            <span>0 SOL</span>
                            <span id="currentRaised">0 SOL</span>
                            <span>1,000 SOL</span>
                        </div>
                    </div>
                </div>

                <div class="p-4 md:p-6 lg:p-8">
                    <!-- Mobile Wallet Instructions -->
                    <div id="mobileWalletHelp" class="mb-4 p-3 bg-blue-50 rounded-xl border border-blue-200 text-sm hidden">
                        <p class="text-blue-700"><i class="fas fa-mobile-alt mr-2"></i>On mobile? Open in Phantom browser app for best experience.</p>
                        <a href="https://phantom.app" target="_blank" class="phantom-deep-link mt-2 inline-block">
                            <i class="fas fa-external-link-alt mr-2"></i>Open in Phantom
                        </a>
                    </div>

                    <!-- Connection Status -->
                    <div id="walletStatus" class="mb-4 md:mb-6 p-3 md:p-4 bg-gradient-to-r from-amber-50 to-orange-50 rounded-xl text-center border border-amber-200">
                        <p class="text-amber-700 text-sm md:text-base"><i class="fas fa-info-circle mr-2"></i>Connect wallet to participate</p>
                    </div>

                    <!-- Wallet Info -->
                    <div id="walletInfo" class="hidden mb-4 md:mb-6 p-3 md:p-4 bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl border border-green-200">
                        <div class="flex justify-between items-center">
                            <div class="overflow-hidden">
                                <p class="font-medium text-green-800 text-sm md:text-base"><i class="fas fa-check-circle mr-2"></i>Connected</p>
                                <p id="walletAddress" class="text-xs md:text-sm text-green-600 font-mono truncate"></p>
                            </div>
                            <button onclick="disconnectWallet()" class="text-red-600 hover:text-red-800 ml-2">
                                <i class="fas fa-sign-out-alt"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Amount Input -->
                    <div class="mb-4 md:mb-6">
                        <label class="block text-gray-700 mb-2 md:mb-3 font-semibold text-base md:text-lg">
                            <i class="fas fa-coins mr-2"></i>Amount (SOL)
                        </label>
                        <div class="relative">
                            <input type="number" id="amount" value="0.1" min="0.01" step="0.01" 
                                   class="w-full bg-gray-50 border-2 border-orange-300 rounded-xl py-3 md:py-4 px-4 md:px-6 text-xl md:text-2xl font-bold pr-12 md:pr-20 touch-target">
                            <div class="absolute right-4 md:right-6 top-1/2 transform -translate-y-1/2 text-xl md:text-2xl">‚óé</div>
                        </div>
                        <div class="text-xs md:text-sm text-gray-500 mt-1 md:mt-2">
                            <i class="fas fa-info-circle mr-1"></i> Min: 0.01 SOL ‚Ä¢ Max: 100 SOL
                        </div>
                    </div>

                    <!-- Quick Select -->
                    <div class="mb-4 md:mb-6">
                        <div class="text-xs md:text-sm text-gray-600 mb-2 md:mb-3"><i class="fas fa-bolt mr-2"></i>Quick select:</div>
                        <div class="grid grid-cols-3 md:grid-cols-5 gap-2">
                            <button class="quick-amount py-2 md:py-3 bg-gray-100 hover:bg-orange-100 border border-gray-300 hover:border-orange-400 rounded-lg transition-colors touch-target" data-amount="0.1">0.1</button>
                            <button class="quick-amount py-2 md:py-3 bg-gray-100 hover:bg-orange-100 border border-gray-300 hover:border-orange-400 rounded-lg transition-colors touch-target" data-amount="0.5">0.5</button>
                            <button class="quick-amount py-2 md:py-3 bg-gray-100 hover:bg-orange-100 border border-gray-300 hover:border-orange-400 rounded-lg transition-colors touch-target" data-amount="1">1</button>
                            <button class="quick-amount py-2 md:py-3 bg-gray-100 hover:bg-orange-100 border border-gray-300 hover:border-orange-400 rounded-lg touch-target mobile-hidden md:block" data-amount="2">2</button>
                            <button class="quick-amount py-2 md:py-3 bg-gray-100 hover:bg-orange-100 border border-gray-300 hover:border-orange-400 rounded-lg touch-target mobile-hidden md:block" data-amount="5">5</button>
                        </div>
                    </div>

                    <!-- Referral Code -->
                    <div class="mb-4 md:mb-6">
                        <label class="block text-gray-700 mb-2 md:mb-3 font-semibold text-sm md:text-base">
                            <i class="fas fa-user-friends mr-2"></i>Referral Code (5% Bonus!)
                        </label>
                        <div class="relative">
                            <input type="text" id="referralCode" 
                                   class="w-full border-2 border-purple-300 rounded-xl py-2 md:py-3 px-3 md:px-4 pr-24 md:pr-32 touch-target" 
                                   placeholder="ROOFY code">
                            <div class="absolute right-2 md:right-3 top-1/2 transform -translate-y-1/2">
                                <span class="px-2 py-1 md:px-3 md:py-1 bg-purple-100 text-purple-800 rounded-full text-xs md:text-sm font-medium">+5%</span>
                            </div>
                        </div>
                    </div>

                    <!-- Tokens Display -->
                    <div class="bg-gradient-to-r from-orange-50 to-amber-50 rounded-xl p-4 md:p-6 mb-4 md:mb-6 border border-orange-200">
                        <div class="space-y-2 md:space-y-4">
                            <div class="flex justify-between items-center">
                                <span class="text-gray-700 text-sm md:text-base">Base tokens:</span>
                                <span class="font-bold text-base md:text-lg" id="baseTokens">0</span>
                            </div>
                            <div class="flex justify-between items-center text-green-600 hidden" id="bonusSection">
                                <span class="text-sm md:text-base">Bonus (5%):</span>
                                <span class="font-bold text-base md:text-lg" id="bonusTokens">0</span>
                            </div>
                            <div class="border-t border-orange-300 pt-2 md:pt-4">
                                <div class="flex justify-between items-center">
                                    <div>
                                        <div class="font-semibold text-base md:text-lg">Total receive:</div>
                                        <div class="text-xs md:text-sm text-gray-600">Airdropped after presale</div>
                                    </div>
                                    <div class="text-right">
                                        <div id="totalTokens" class="text-xl md:text-3xl font-bold text-orange-600">0</div>
                                        <div class="text-xs md:text-sm">ROOFY tokens</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Buy Button -->
                    <button id="buyButton" 
                            class="w-full gradient-bg text-white py-3 md:py-5 rounded-xl text-base md:text-xl font-bold hover:opacity-90 transition-all disabled:opacity-50 touch-target"
                            disabled>
                        <i class="fas fa-lock mr-2"></i><span id="buyButtonText">CONNECT WALLET</span>
                    </button>

                    <!-- Transaction Status -->
                    <div id="transactionStatus" class="mt-3 md:mt-4 hidden">
                        <div class="bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-3 md:p-4 border border-green-200">
                            <div class="flex items-center">
                                <div class="text-green-500 text-xl md:text-2xl mr-2 md:mr-3">
                                    <i class="fas fa-check-circle"></i>
                                </div>
                                <div>
                                    <p class="font-medium text-green-800 text-sm md:text-base">Transaction Submitted!</p>
                                    <p id="txHash" class="text-xs md:text-sm text-green-500 font-mono mt-1 truncate"></p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Purchases -->
                    <div class="mt-6 md:mt-8 pt-4 md:pt-6 border-t border-gray-200">
                        <h4 class="font-bold mb-2 md:mb-4 text-base md:text-lg"><i class="fas fa-history mr-2"></i>Recent Purchases</h4>
                        <div id="recentPurchases" class="space-y-2 md:space-y-3 max-h-40 md:max-h-48 overflow-y-auto">
                            <div class="text-center text-gray-500 py-3 md:py-4 text-sm">
                                <i class="fas fa-sync-alt animate-spin mr-2"></i>Loading purchases...
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Meme Gallery Section -->
            <div id="memes" class="mt-12 md:mt-16">
                <div class="text-center mb-6 md:mb-8">
                    <h2 class="text-2xl md:text-3xl font-bold mb-3 md:mb-4">üñºÔ∏è Roofy Meme Gallery</h2>
                    <p class="text-gray-600 text-base md:text-lg max-w-2xl mx-auto">Share your favorite Roofy memes! The best memes get bonus tokens.</p>
                </div>

                <div class="meme-grid mb-8" id="memeGallery">
                    <!-- Meme 1 -->
                    <div class="meme-item bg-white rounded-2xl overflow-hidden shadow-lg border border-orange-200">
                        <div class="p-4 text-center">
                            <div class="text-4xl mb-3">ü¶äü¶ñ</div>
                            <h4 class="font-bold text-lg mb-2">Roofy the Dino-Dog</h4>
                            <p class="text-gray-600 text-sm mb-3">"When your Shiba thinks he's a T-Rex"</p>
                            <button class="share-meme px-4 py-2 bg-orange-100 text-orange-700 rounded-lg text-sm font-medium">
                                <i class="fas fa-share mr-2"></i>Share
                            </button>
                        </div>
                    </div>

                    <!-- Meme 2 -->
                    <div class="meme-item bg-white rounded-2xl overflow-hidden shadow-lg border border-orange-200">
                        <div class="p-4 text-center">
                            <div class="text-4xl mb-3">üåÖü¶ä</div>
                            <h4 class="font-bold text-lg mb-2">Sunset Roofy</h4>
                            <p class="text-gray-600 text-sm mb-3">"Watching sunsets with Lily"</p>
                            <button class="share-meme px-4 py-2 bg-orange-100 text-orange-700 rounded-lg text-sm font-medium">
                                <i class="fas fa-share mr-2"></i>Share
                            </button>
                        </div>
                    </div>

                    <!-- Meme 3 -->
                    <div class="meme-item bg-white rounded-2xl overflow-hidden shadow-lg border border-orange-200">
                        <div class="p-4 text-center">
                            <div class="text-4xl mb-3">üöÄüí∞</div>
                            <h4 class="font-bold text-lg mb-2">To the Moon!</h4>
                            <p class="text-gray-600 text-sm mb-3">"When Roofy hits $1"</p>
                            <button class="share-meme px-4 py-2 bg-orange-100 text-orange-700 rounded-lg text-sm font-medium">
                                <i class="fas fa-share mr-2"></i>Share
                            </button>
                        </div>
                    </div>

                    <!-- Meme 4 -->
                    <div class="meme-item bg-white rounded-2xl overflow-hidden shadow-lg border border-orange-200">
                        <div class="p-4 text-center">
                            <div class="text-4xl mb-3">üëß‚ù§Ô∏è</div>
                            <h4 class="font-bold text-lg mb-2">Lily's Best Friend</h4>
                            <p class="text-gray-600 text-sm mb-3">"A love that lasts forever"</p>
                            <button class="share-meme px-4 py-2 bg-orange-100 text-orange-700 rounded-lg text-sm font-medium">
                                <i class="fas fa-share mr-2"></i>Share
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Upload Meme Section with Netlify Forms -->
                <div class="bg-gradient-to-r from-purple-50 to-pink-50 rounded-2xl p-6 md:p-8 border border-purple-200">
                    <h3 class="text-xl md:text-2xl font-bold mb-4 text-center">üì∏ Submit Your Roofy Meme</h3>
                    <div class="max-w-md mx-auto">
                        <!-- Netlify Form -->
                        <form name="meme-submission" method="POST" data-netlify="true" data-netlify-honeypot="bot-field" netlify id="memeForm">
                            <!-- Hidden fields for Netlify -->
                            <input type="hidden" name="form-name" value="meme-submission">
                            <div class="hidden">
                                <label>Don't fill this out if you're human: <input name="bot-field"></label>
                            </div>
                            
                            <div class="mb-4">
                                <input type="text" name="meme-title" placeholder="Meme title" 
                                       class="w-full border border-gray-300 rounded-lg px-4 py-3 mb-3" required>
                                <textarea name="meme-description" placeholder="Describe your meme..." 
                                          class="w-full border border-gray-300 rounded-lg px-4 py-3 h-24" required></textarea>
                            </div>
                            
                            <!-- Image URL input -->
                            <div class="mb-4">
                                <label class="block text-gray-700 mb-2">
                                    <i class="fas fa-link mr-2"></i>Meme Image URL
                                </label>
                                <input type="url" name="meme-image-url" 
                                       placeholder="https://imgur.com/your-meme.png" 
                                       class="w-full border border-gray-300 rounded-lg px-4 py-3"
                                       required>
                                <p class="text-xs text-gray-500 mt-1">
                                    Upload your meme to <a href="https://imgur.com" target="_blank" class="text-purple-600">Imgur</a> 
                                    or <a href="https://imgbb.com" target="_blank" class="text-purple-600">ImgBB</a> and paste the link here
                                </p>
                            </div>
                            
                            <!-- Wallet Address for token bonus -->
                            <div class="mb-4">
                                <label class="block text-gray-700 mb-2">
                                    <i class="fas fa-wallet mr-2"></i>Your Solana Wallet (for bonus tokens)
                                </label>
                                <input type="text" name="wallet-address" 
                                       placeholder="BLKj7mTgRa9Fg1vCDqZeNaBSjyekF4xpK72fMWikZYmq"
                                       class="w-full border border-gray-300 rounded-lg px-4 py-3"
                                       pattern="^[1-9A-HJ-NP-Za-km-z]{32,44}$">
                                <p class="text-xs text-gray-500 mt-1">
                                    Optional: Provide your wallet address to receive bonus tokens if your meme wins
                                </p>
                            </div>
                            
                            <!-- Social Media -->
                            <div class="mb-4">
                                <label class="block text-gray-700 mb-2">
                                    <i class="fas fa-hashtag mr-2"></i>Your Twitter/X Handle
                                </label>
                                <input type="text" name="twitter-handle" 
                                       placeholder="@YourTwitterHandle"
                                       class="w-full border border-gray-300 rounded-lg px-4 py-3">
                            </div>
                            
                            <!-- Submit Button -->
                            <div class="text-center">
                                <button type="submit" class="px-6 py-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-lg font-semibold hover:opacity-90 transition-all">
                                    <i class="fas fa-upload mr-2"></i>Submit Meme
                                </button>
                                <p class="text-sm text-gray-600 mt-3">
                                    Best memes win bonus ROOFY tokens! Submissions are stored in Netlify.
                                </p>
                            </div>
                        </form>
                        
                        <!-- Success Message -->
                        <div id="formSuccess" class="hidden mt-4 p-4 bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl border border-green-200">
                            <div class="flex items-center">
                                <div class="text-green-500 text-xl mr-3">
                                    <i class="fas fa-check-circle"></i>
                                </div>
                                <div>
                                    <p class="font-medium text-green-800">Meme submitted successfully!</p>
                                    <p class="text-sm text-green-600 mt-1">Thank you for your submission. We'll review it soon!</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Error Message -->
                        <div id="formError" class="hidden mt-4 p-4 bg-gradient-to-r from-red-50 to-pink-50 rounded-xl border border-red-200">
                            <div class="flex items-center">
                                <div class="text-red-500 text-xl mr-3">
                                    <i class="fas fa-exclamation-circle"></i>
                                </div>
                                <div>
                                    <p class="font-medium text-red-800">Submission failed</p>
                                    <p class="text-sm text-red-600 mt-1" id="errorMessage">Please try again</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Story Section -->
            <div id="story" class="mt-12 md:mt-16 max-w-3xl mx-auto">
                <div class="bg-gradient-to-br from-amber-50 to-orange-50 rounded-2xl p-6 md:p-8 border border-amber-200">
                    <div class="flex items-center mb-4 md:mb-6">
                        <div class="text-2xl md:text-3xl mr-3">üìñ</div>
                        <h3 class="text-xl md:text-2xl font-bold text-gray-800">The Roofy Story</h3>
                    </div>
                    
                    <div class="space-y-4 md:space-y-6">
                        <div class="flex items-start">
                            <div class="text-xl md:text-2xl mr-3 md:mr-4 flex-shrink-0">ü¶ä</div>
                            <div>
                                <h4 class="font-bold text-base md:text-lg mb-1 md:mb-2">Our Shiba Rusty</h4>
                                <p class="text-gray-700 text-sm md:text-base">A curious, loyal Shiba Inu with the classic smile.</p>
                            </div>
                        </div>
                        
                        <div class="flex items-start">
                            <div class="text-xl md:text-2xl mr-3 md:mr-4 flex-shrink-0">üëß</div>
                            <div>
                                <h4 class="font-bold text-base md:text-lg mb-1 md:mb-2">Lily's Magic</h4>
                                <p class="text-gray-700 text-sm md:text-base">"Look! Rusty turned into ROOFY the dinosaur!" she'd giggle.</p>
                            </div>
                        </div>
                        
                        <div class="flex items-start">
                            <div class="text-xl md:text-2xl mr-3 md:mr-4 flex-shrink-0">üåÖ</div>
                            <div>
                                <h4 class="font-bold text-base md:text-lg mb-1 md:mb-2">Sunset Ritual</h4>
                                <p class="text-gray-700 text-sm md:text-base">Evening dino-costume zoomies filled our home with laughter.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tokenomics -->
            <div id="tokenomics" class="mt-12 md:mt-16 max-w-3xl mx-auto">
                <div class="bg-white rounded-2xl p-6 md:p-8 shadow-lg border border-orange-200">
                    <h3 class="text-xl md:text-2xl font-bold mb-4 md:mb-6"><i class="fas fa-chart-pie mr-2"></i>Tokenomics</h3>
                    
                    <div class="space-y-4 md:space-y-6">
                        <div>
                            <h4 class="font-bold text-base md:text-lg mb-2 md:mb-3">üìä Distribution</h4>
                            <div class="space-y-2 md:space-y-3">
                                <div class="flex justify-between items-center text-sm md:text-base">
                                    <span>Presale (50%)</span>
                                    <span class="font-bold">500,000,000 ROOFY</span>
                                </div>
                                <div class="flex justify-between items-center text-sm md:text-base">
                                    <span>Liquidity (30%)</span>
                                    <span class="font-bold">300,000,000 ROOFY</span>
                                </div>
                                <div class="flex justify-between items-center text-sm md:text-base">
                                    <span>Marketing (10%)</span>
                                    <span class="font-bold">100,000,000 ROOFY</span>
                                </div>
                                <div class="flex justify-between items-center text-sm md:text-base">
                                    <span>Lily's Fund (10%)</span>
                                    <span class="font-bold">100,000,000 ROOFY</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gradient-to-r from-gray-900 to-black text-white py-8 md:py-12 mt-12 md:mt-16">
        <div class="max-w-6xl mx-auto px-4">
            <div class="grid md:grid-cols-3 gap-6 md:gap-8">
                <div>
                    <div class="flex items-center mb-4 md:mb-6">
                        <img src="https://chocolate-solid-skunk-453.mypinata.cloud/ipfs/bafkreigq22tzxessrj6mvdfcgw4xchwxcphvbbblrylwfunr2w63nhq7xq" alt="Roofy Logo" class="w-10 h-10 rounded-full mr-3">
                        <div>
                            <h3 class="text-xl md:text-2xl font-bold">$ROOFY</h3>
                            <p class="text-xs text-gray-400">The Shiba Dino-Dog</p>
                        </div>
                    </div>
                    <p class="text-gray-400 text-sm">
                        A memorial token keeping Lily's magic alive.
                    </p>
                </div>
                
                <div>
                    <h4 class="text-base md:text-lg font-bold mb-3 md:mb-4">Links</h4>
                    <div class="space-y-2">
                        <a href="#presale" class="block text-gray-400 hover:text-white text-sm md:text-base">Presale</a>
                        <a href="#token" class="block text-gray-400 hover:text-white text-sm md:text-base">Token</a>
                        <a href="#memes" class="block text-gray-400 hover:text-white text-sm md:text-base">Memes</a>
                        <a href="#story" class="block text-gray-400 hover:text-white text-sm md:text-base">Story</a>
                    </div>
                </div>
                
                <div>
                    <h4 class="text-base md:text-lg font-bold mb-3 md:mb-4">In Memory</h4>
                    <div class="bg-gray-800/30 rounded-xl p-3 md:p-4">
                        <p class="text-gray-400 text-xs md:text-sm">
                            "For Lily, who saw dinosaurs in every Shiba."
                        </p>
                    </div>
                </div>
            </div>
            
            <!-- Netlify Badge -->
            <div class="mt-8 text-center">
                <a href="https://www.netlify.com" target="_blank">
                    <img src="https://www.netlify.com/v3/img/components/netlify-light.svg" alt="Deploys by Netlify" class="inline-block h-8 opacity-50 hover:opacity-100 transition-opacity">
                </a>
                <p class="text-gray-500 text-xs mt-2">Meme submissions powered by Netlify Forms</p>
            </div>
            
            <div class="mt-6 md:mt-8 pt-6 md:pt-8 border-t border-gray-800 text-center text-gray-500 text-xs md:text-sm">
                <p>This is a memecoin. Invest responsibly. 10% goes to charity.</p>
            </div>
        </div>
    </footer>

    <script>
        // =============== CONFIGURATION ===============
        const DEV_WALLET = 'BLKj7mTgRa9Fg1vCDqZeNaBSjyekF4xpK72fMWikZYmq';
        
        // FIXED: Increased to 1,000 SOL hard cap
        const PRESALE_CAP = 1000; // 1,000 SOL hard cap
        const MIN_PURCHASE = 0.01;
        const MAX_PURCHASE = 100;
        const REFERRAL_BONUS = 0.05; // 5%
        
        // Tiered pricing for 1,000 SOL cap
        const TIERS = [
            {
                range: [0, 250],        // First 250 SOL
                tokensPerSOL: 300_000,   // 300K per SOL
                name: 'Early Dino',
                bonus: '50% Bonus'
            },
            {
                range: [250, 500],      // Next 250 SOL
                tokensPerSOL: 250_000,   // 250K per SOL
                name: 'Shiba Warrior',
                bonus: '25% Bonus'
            },
            {
                range: [500, 750],      // Next 250 SOL
                tokensPerSOL: 200_000,   // 200K per SOL
                name: 'Dino Pack',
                bonus: 'Base Price'
            },
            {
                range: [750, 1000],     // Last 250 SOL
                tokensPerSOL: 150_000,   // 150K per SOL
                name: 'Community',
                bonus: 'Reduced Price'
            }
        ];

        // =============== STATE ===============
        let wallet = null;
        let publicKey = null;
        let connection = null;
        let totalRaised = 0;
        let recentPurchases = [];
        let isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);

        // =============== INITIALIZATION ===============
        document.addEventListener('DOMContentLoaded', () => {
            // Mobile detection and help
            if (isMobile) {
                document.getElementById('mobileWalletHelp').classList.remove('hidden');
            }
            
            // Mobile menu toggle
            document.getElementById('mobileMenu').addEventListener('click', () => {
                const menu = document.getElementById('mobileMenuContent');
                menu.classList.toggle('hidden');
            });
            
            // Check if Phantom is available
            if (window.solana && window.solana.isPhantom) {
                wallet = window.solana;
                wallet.on('connect', () => handleWalletConnect(wallet.publicKey));
                wallet.on('disconnect', () => handleWalletDisconnect());
                
                if (wallet.isConnected) {
                    handleWalletConnect(wallet.publicKey);
                }
            } else if (isMobile) {
                // Show mobile-specific instructions
                showMobileWalletInstructions();
            }

            // Initialize connection
            connection = new solanaWeb3.Connection(
                solanaWeb3.clusterApiUrl('devnet'),
                'confirmed'
            );

            // Set up event listeners
            setupEventListeners();
            
            // Initialize UI
            updateTokenCalculation();
            simulateLiveStats();
            loadRecentPurchases();
            
            // Setup Netlify form submission
            setupNetlifyForm();
            
            // Load user-submitted memes from localStorage (for demo)
            loadUserMemes();
        });

        // =============== COPY TOKEN ADDRESS ===============
        function copyTokenAddress() {
            const tokenAddress = 'BLKj7mTgRa9Fg1vCDqZeNaBSjyekF4xpK72fMWikZYmq';
            navigator.clipboard.writeText(tokenAddress).then(() => {
                showNotification('Token address copied to clipboard!', 'success');
            }).catch(err => {
                showNotification('Failed to copy address', 'error');
            });
        }

        // =============== NETLIFY FORM HANDLING ===============
        function setupNetlifyForm() {
            const form = document.getElementById('memeForm');
            
            if (form) {
                form.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    
                    const submitButton = form.querySelector('button[type="submit"]');
                    const originalText = submitButton.innerHTML;
                    
                    // Show loading state
                    submitButton.disabled = true;
                    submitButton.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Submitting...';
                    
                    // Hide any previous messages
                    document.getElementById('formSuccess').classList.add('hidden');
                    document.getElementById('formError').classList.add('hidden');
                    
                    try {
                        // Netlify will handle the form submission automatically
                        // We'll just show success message
                        await new Promise(resolve => setTimeout(resolve, 1500)); // Simulate submission
                        
                        // Show success message
                        document.getElementById('formSuccess').classList.remove('hidden');
                        
                        // Add meme to gallery (for demo - in real app, you'd fetch from Netlify)
                        addMemeToGallery(
                            form.querySelector('[name="meme-title"]').value,
                            form.querySelector('[name="meme-description"]').value,
                            form.querySelector('[name="meme-image-url"]').value
                        );
                        
                        // Reset form
                        form.reset();
                        
                        // Scroll to show the new meme
                        document.getElementById('memeGallery').scrollIntoView({ behavior: 'smooth' });
                        
                    } catch (error) {
                        // Show error message
                        document.getElementById('formError').classList.remove('hidden');
                        document.getElementById('errorMessage').textContent = error.message || 'Please try again';
                    } finally {
                        // Reset button
                        submitButton.disabled = false;
                        submitButton.innerHTML = originalText;
                    }
                });
            }
        }

        function addMemeToGallery(title, description, imageUrl) {
            const memeGrid = document.getElementById('memeGallery');
            
            const memeItem = document.createElement('div');
            memeItem.className = 'meme-item bg-white rounded-2xl overflow-hidden shadow-lg border border-orange-200';
            
            let imageContent = '<div class="text-4xl mb-3">ü¶äü¶ñ</div>';
            if (imageUrl && imageUrl.startsWith('http')) {
                imageContent = `
                    <div class="h-32 overflow-hidden flex items-center justify-center bg-gray-100">
                        <img src="${imageUrl}" alt="${title}" class="max-h-full max-w-full object-contain" 
                             onerror="this.style.display='none'; this.parentElement.innerHTML='<div class=\\'text-4xl\\'>ü¶äü¶ñ</div>';">
                    </div>
                `;
            }
            
            memeItem.innerHTML = `
                <div class="p-4 text-center">
                    ${imageContent}
                    <h4 class="font-bold text-lg mb-2">${title}</h4>
                    <p class="text-gray-600 text-sm mb-3">${description}</p>
                    <p class="text-xs text-purple-600 mb-3"><i class="fas fa-user mr-1"></i> User Submitted</p>
                    <button class="share-meme px-4 py-2 bg-orange-100 text-orange-700 rounded-lg text-sm font-medium">
                        <i class="fas fa-share mr-2"></i>Share
                    </button>
                </div>
            `;
            
            memeGrid.prepend(memeItem);
            
            memeItem.querySelector('.share-meme').addEventListener('click', () => {
                shareMeme(title);
            });
            
            showNotification('Meme added to gallery!', 'success');
            storeMemeInLocalStorage(title, description, imageUrl);
        }

        function loadUserMemes() {
            try {
                const storedMemes = JSON.parse(localStorage.getItem('roofyMemes')) || [];
                
                storedMemes.forEach(meme => {
                    setTimeout(() => {
                        addMemeToGallery(meme.title, meme.description, meme.imageUrl);
                    }, 100);
                });
            } catch (error) {
                console.log('Could not load stored memes');
            }
        }

        function storeMemeInLocalStorage(title, description, imageUrl) {
            try {
                const storedMemes = JSON.parse(localStorage.getItem('roofyMemes')) || [];
                storedMemes.unshift({
                    title,
                    description,
                    imageUrl,
                    timestamp: new Date().toISOString()
                });
                
                if (storedMemes.length > 20) {
                    storedMemes.pop();
                }
                
                localStorage.setItem('roofyMemes', JSON.stringify(storedMemes));
            } catch (error) {
                console.log('Could not store meme in localStorage');
            }
        }

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 p-4 rounded-xl shadow-lg z-50 ${
                type === 'success' ? 'bg-green-500 text-white' : 
                type === 'error' ? 'bg-red-500 text-white' : 
                'bg-blue-500 text-white'
            }`;
            notification.innerHTML = `
                <div class="flex items-center">
                    <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'} mr-2"></i>
                    <span>${message}</span>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.classList.add('opacity-0', 'transition-opacity', 'duration-300');
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }

        // =============== MOBILE WALLET HANDLING ===============
        function showMobileWalletInstructions() {
            const helpDiv = document.getElementById('mobileWalletHelp');
            if (!helpDiv.classList.contains('hidden')) {
                const connectBtn = document.getElementById('connectWallet');
                connectBtn.innerHTML = '<i class="fas fa-external-link-alt mr-2"></i>Open in Phantom';
                connectBtn.onclick = () => {
                    window.location.href = 'https://phantom.app/ul/browse/' + encodeURIComponent(window.location.href);
                };
            }
        }

        function handleMobileTransaction() {
            if (isMobile && (!window.solana || !window.solana.isPhantom)) {
                const amount = document.getElementById('amount').value;
                const url = `https://phantom.app/ul/sign/${encodeURIComponent(window.location.href)}?amount=${amount}`;
                window.location.href = url;
                return true;
            }
            return false;
        }

        // =============== TIER FUNCTIONS ===============
        function getCurrentTier() {
            for (const tier of TIERS) {
                if (totalRaised >= tier.range[0] && totalRaised < tier.range[1]) {
                    return tier;
                }
            }
            return TIERS[TIERS.length - 1];
        }

        // =============== WALLET FUNCTIONS ===============
        async function handleWalletConnect(publicKeyObj) {
            publicKey = publicKeyObj.toString();
            
            const shortAddress = publicKey.slice(0, 4) + '...' + publicKey.slice(-4);
            document.getElementById('connectWallet').innerHTML = `<i class="fas fa-wallet mr-2"></i>${shortAddress}`;
            document.getElementById('connectWallet').classList.add('wallet-connected');
            document.getElementById('walletStatus').classList.add('hidden');
            document.getElementById('walletInfo').classList.remove('hidden');
            document.getElementById('walletAddress').textContent = shortAddress;
            document.getElementById('buyButton').disabled = false;
            document.getElementById('buyButtonText').textContent = 'BUY ROOFY TOKENS';
            
            try {
                const balance = await connection.getBalance(publicKeyObj);
                console.log(`Balance: ${balance / solanaWeb3.LAMPORTS_PER_SOL} SOL`);
            } catch (err) {
                console.log('Could not fetch balance');
            }
        }

        function handleWalletDisconnect() {
            publicKey = null;
            document.getElementById('connectWallet').innerHTML = '<i class="fas fa-wallet mr-2"></i>Connect';
            document.getElementById('connectWallet').classList.remove('wallet-connected');
            document.getElementById('walletStatus').classList.remove('hidden');
            document.getElementById('walletInfo').classList.add('hidden');
            document.getElementById('buyButton').disabled = true;
            document.getElementById('buyButtonText').textContent = 'CONNECT WALLET';
            document.getElementById('transactionStatus').classList.add('hidden');
        }

        // =============== EVENT LISTENERS ===============
        function setupEventListeners() {
            document.getElementById('connectWallet').addEventListener('click', async () => {
                if (!wallet && isMobile) {
                    window.open('https://phantom.app', '_blank');
                    return;
                }
                
                if (!wallet) {
                    alert('Please install Phantom wallet from phantom.app');
                    return;
                }

                try {
                    await wallet.connect();
                } catch (err) {
                    console.error('Connection error:', err);
                    alert('Failed to connect wallet. Please try again.');
                }
            });

            document.querySelectorAll('.quick-amount').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.getElementById('amount').value = btn.dataset.amount;
                    updateTokenCalculation();
                });
            });

            document.getElementById('amount').addEventListener('input', updateTokenCalculation);
            document.getElementById('referralCode').addEventListener('input', updateTokenCalculation);
            document.getElementById('buyButton').addEventListener('click', handlePurchase);
            
            document.querySelectorAll('.share-meme').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const memeTitle = e.target.closest('.meme-item').querySelector('h4').textContent;
                    shareMeme(memeTitle);
                });
            });
        }

        // =============== TOKEN CALCULATION ===============
        function updateTokenCalculation() {
            const amount = parseFloat(document.getElementById('amount').value) || 0;
            const currentTier = getCurrentTier();
            
            document.getElementById('currentPrice').textContent = 
                `${Math.floor(currentTier.tokensPerSOL).toLocaleString()}K`;
            
            const baseTokens = Math.floor(amount * currentTier.tokensPerSOL);
            
            const hasReferral = document.getElementById('referralCode').value.trim().length > 0;
            const bonusTokens = hasReferral ? Math.floor(baseTokens * REFERRAL_BONUS) : 0;
            const totalTokens = baseTokens + bonusTokens;

            document.getElementById('baseTokens').textContent = baseTokens.toLocaleString();
            document.getElementById('totalTokens').textContent = totalTokens.toLocaleString();
            
            if (hasReferral && bonusTokens > 0) {
                document.getElementById('bonusSection').classList.remove('hidden');
                document.getElementById('bonusTokens').textContent = `+${bonusTokens.toLocaleString()}`;
            } else {
                document.getElementById('bonusSection').classList.add('hidden');
            }
        }

        // =============== PURCHASE HANDLING ===============
        async function handlePurchase() {
            if (!publicKey) {
                alert('Please connect your wallet first');
                return;
            }

            const amount = parseFloat(document.getElementById('amount').value);
            
            if (isNaN(amount) || amount < MIN_PURCHASE) {
                alert(`Minimum purchase is ${MIN_PURCHASE} SOL`);
                return;
            }

            if (amount > MAX_PURCHASE) {
                alert(`Maximum purchase per transaction is ${MAX_PURCHASE} SOL`);
                return;
            }

            if (totalRaised + amount > PRESALE_CAP) {
                alert(`Purchase would exceed hard cap! Maximum remaining: ${(PRESALE_CAP - totalRaised).toFixed(2)} SOL`);
                return;
            }

            if (isMobile && (!window.solana || !window.solana.isPhantom)) {
                if (handleMobileTransaction()) return;
            }

            const buyButton = document.getElementById('buyButton');
            const originalText = buyButton.innerHTML;
            buyButton.disabled = true;
            buyButton.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Processing...';

            try {
                const transaction = new solanaWeb3.Transaction().add(
                    solanaWeb3.SystemProgram.transfer({
                        fromPubkey: new solanaWeb3.PublicKey(publicKey),
                        toPubkey: new solanaWeb3.PublicKey(DEV_WALLET),
                        lamports: Math.floor(amount * solanaWeb3.LAMPORTS_PER_SOL * 0.99),
                    })
                );

                const { blockhash, lastValidBlockHeight } = await connection.getLatestBlockhash();
                transaction.recentBlockhash = blockhash;
                transaction.feePayer = new solanaWeb3.PublicKey(publicKey);

                let signature;
                if (isMobile && wallet) {
                    const { signature: sig } = await wallet.signAndSendTransaction(transaction);
                    signature = sig;
                } else {
                    const signedTransaction = await wallet.signTransaction(transaction);
                    signature = await connection.sendRawTransaction(signedTransaction.serialize());
                }

                await connection.confirmTransaction({
                    signature,
                    blockhash,
                    lastValidBlockHeight
                }, 'confirmed');

                document.getElementById('transactionStatus').classList.remove('hidden');
                document.getElementById('txHash').textContent = `TX: ${signature.slice(0, 8)}...`;
                
                totalRaised += amount;
                updateStats();
                
                addRecentPurchase(amount, signature);
                
                const currentTier = getCurrentTier();
                const baseTokens = Math.floor(amount * currentTier.tokensPerSOL);
                const bonus = document.getElementById('referralCode').value.trim() ? 
                    Math.floor(baseTokens * REFERRAL_BONUS) : 0;
                const total = baseTokens + bonus;
                
                showNotification(`‚úÖ Purchase Successful! ${total.toLocaleString()} ROOFY tokens`, 'success');

                document.getElementById('amount').value = '0.1';
                document.getElementById('referralCode').value = '';
                updateTokenCalculation();

            } catch (err) {
                console.error('Transaction error:', err);
                showNotification(`Transaction failed: ${err.message || 'Please try again'}`, 'error');
                
                if (isMobile && err.message?.includes('User rejected')) {
                    showNotification('Please approve the transaction in Phantom app', 'error');
                }
            } finally {
                buyButton.disabled = false;
                buyButton.innerHTML = originalText;
            }
        }

        // =============== STATS UPDATES ===============
        function updateStats() {
            const progress = (totalRaised / PRESALE_CAP) * 100;
            const currentTier = getCurrentTier();
            
            document.getElementById('progressBar').style.width = `${progress}%`;
            document.getElementById('progressPercent').textContent = `${progress.toFixed(1)}%`;
            document.getElementById('currentRaised').textContent = `${totalRaised.toFixed(2)} SOL`;
            document.getElementById('totalRaised').textContent = totalRaised.toFixed(2);
            document.getElementById('currentPrice').textContent = 
                `${Math.floor(currentTier.tokensPerSOL).toLocaleString()}K`;
        }

        function simulateLiveStats() {
            totalRaised = 245.67;
            updateStats();
            document.getElementById('totalBuyers').textContent = '124';
            
            setInterval(() => {
                if (Math.random() > 0.7) {
                    const randomAmount = 0.1 + Math.random() * 5;
                    totalRaised += randomAmount;
                    if (totalRaised > PRESALE_CAP) totalRaised = PRESALE_CAP;
                    updateStats();
                    
                    if (recentPurchases.length < 5) {
                        addRecentPurchase(randomAmount, `sim_${Date.now()}`);
                    }
                }
            }, 10000);
        }

        function addRecentPurchase(amount, txHash) {
            const now = new Date();
            const timeString = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            const currentTier = getCurrentTier();
            const tokens = Math.floor(amount * currentTier.tokensPerSOL);
            
            recentPurchases.unshift({
                time: timeString,
                amount: amount.toFixed(2),
                tokens: tokens.toLocaleString(),
                tier: currentTier.name.substring(0, 10)
            });
            
            if (recentPurchases.length > 5) {
                recentPurchases.pop();
            }
            
            loadRecentPurchases();
        }

        function loadRecentPurchases() {
            const container = document.getElementById('recentPurchases');
            container.innerHTML = '';
            
            if (recentPurchases.length === 0) {
                container.innerHTML = `
                    <div class="text-center text-gray-500 py-4 text-sm">
                        <i class="fas fa-shopping-cart mr-2"></i>No purchases yet
                    </div>
                `;
                return;
            }
            
            recentPurchases.forEach(purchase => {
                const purchaseEl = document.createElement('div');
                purchaseEl.className = 'flex justify-between items-center p-2 hover:bg-orange-50 rounded-lg text-sm';
                purchaseEl.innerHTML = `
                    <div class="flex items-center">
                        <div class="w-2 h-2 bg-green-500 rounded-full mr-2"></div>
                        <div>
                            <div class="font-medium">${purchase.time}</div>
                            <div class="text-xs text-gray-500">${purchase.tier}</div>
                        </div>
                    </div>
                    <div class="text-right">
                        <div class="font-bold">${purchase.amount} SOL</div>
                        <div class="text-xs text-orange-600">${purchase.tokens} ROOFY</div>
                    </div>
                `;
                container.appendChild(purchaseEl);
            });
        }

        // =============== MEME SHARING ===============
        function shareMeme(memeTitle) {
            const shareText = `Check out this ${memeTitle} meme for $ROOFY presale! ü¶äü¶ñ\n\n`;
            const shareUrl = window.location.href + '#memes';
            
            if (navigator.share) {
                navigator.share({
                    title: `${memeTitle} - Roofy Meme`,
                    text: shareText,
                    url: shareUrl
                });
            } else {
                const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(shareText + shareUrl)}`;
                window.open(twitterUrl, '_blank');
            }
        }

        // =============== HELPER FUNCTIONS ===============
        function disconnectWallet() {
            if (wallet) {
                wallet.disconnect();
            }
            handleWalletDisconnect();
        }

        updateTokenCalculation();
    </script>
</body>
</html>
